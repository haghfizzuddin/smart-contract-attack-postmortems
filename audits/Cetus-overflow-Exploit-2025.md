# Cetus Protocol Overflow Exploit (May 2025)

## Summary
- **Victim:** Cetus Protocol (AMM on Sui Network)
- **Date:** May 22, 2025
- **Total Loss:** ~$223 million USD
- **Primary Root Cause:** Integer overflow in liquidity pool arithmetic (`checked_shlw` function).

---

## Technical Breakdown

### Vulnerability Details
- The exploit stemmed from an **arithmetic overflow flaw** inside the **liquidity minting logic**.
- Specifically, the function intended to perform safe left bit shifts via `checked_shlw`, but in certain edge cases it **truncated high-order bits**, leading to inaccurate share calculations.

### Exploit Path
1. **Attacker deposited a minimal token amount**, triggering the faulty overflow calculation.
2. **LP share was miscalculated**, giving the attacker disproportionate liquidity pool tokens.
3. The attacker **drained the pool by redeeming their shares**, withdrawing far more than deposited.

---

## Impact Overview
- **Stolen funds:** â‰ˆ $223 million drained across multiple pools.
- **Recovery efforts:** ~$163 million frozen by Sui validators shortly after the attack.
- **Affected chains:** Sui Network.

---

## Timeline Snapshot
| Time (UTC) | Event |
|-------------|-------|
| May 22, 2025 | Attack begins via liquidity manipulation. |
| +30 mins | Multiple pools drained. |
| +2 hours | Validator intervention freezes ~73% of stolen funds. |
| +1 day | Cetus releases official post-mortem. |

---

## Mitigation & Lessons Learned

| Category | Actionable Takeaways |
|-----------|----------------------|
| **Development** | Always use proven safe math libraries, even with "safe" low-level bit manipulation. |
| **Testing** | Simulate **edge case liquidity deposits** and **overflow scenarios** during audits. |
| **Operations** | Implement validator-level emergency pause mechanisms (although this comes with trade-offs in decentralization). |

---

## References
- [Crypto.news post-mortem report](https://crypto.news/cetus-hack-post-mortem-reveals-overflow-bug-behind-223m-exploit/)
- [Cointelegraph summary](https://cointelegraph.com/news/dedaub-cetus-hack-post-mortem)
- [Dedaub official analysis](https://dedaub.com/blog/cetus-overflow-attack-sui-223m)

---

## Quick Summary
**Exploited Weakness:** Overflow in liquidity pool math  
**Exploit Impact:** $223M stolen, partial recovery  
**Lesson:** Overflow risks persist even in novel ecosystems like Sui; robust testing is mandatory.

---

 **Last updated:** July 2025  
  **Author:** Hafizzuddin
